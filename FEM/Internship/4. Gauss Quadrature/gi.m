clc
clear all
fprintf('                                Gauss Quadrature for FEM\n');
%% Input Section
d=input('Enter dimension of integration(1,2,3): '); 
I=input('\nEnter Integrand Function in (x,y,z): ','s');
do=zeros(d,1); % _do_ contains order of various variables
if d>0.99
    do(1)=input('Enter Order of x: ');
end
if d>1.99
    do(2)=input('\nEnter Order of y: ');
end
if d>2.99
    do(3)=input('\nEnter Order of z: ');
end
NGP=round((1+do(:,1))/2);   % Number of Gauss Points for each variable
%% CREATING DATABASE OF GAUSS WEIGHTS AND GAUSS POINTS COORDINATES
db_wt=[2,1,0.88888889,0.65214515,0.5688889,0.46791,0.41795918,0.36268378,0.330239,0.295524;
       0,1,0.55555556,0.65214515,0.47862867,0.46791,0.38183,0.36268378,0.312347,0.295524;
       0,0,0.55555556,0.34785484,0.47862867,0.3607615,0.38183,0.313706,0.312347,0.269266;
       0,0,0,0.34785484,0.23692688,0.3607615,0.27970539,0.313706,0.26061,0.269266;
       0,0,0,0,0.23692688,0.17132449,0.27970539,0.222381,0.26061,0.219086;
       0,0,0,0,0,0.17132449,0.129484996,0.222381,0.180648,0.219086;
       0,0,0,0,0,0,0.129484996,0.10122853,0.180648,0.149451;
       0,0,0,0,0,0,0,0.10122853,0.081274,0.149451;
       0,0,0,0,0,0,0,0,0.081274,0.06667;
       0,0,0,0,0,0,0,0,0,0.06667];
 db_gp=[0,0.57735026,0,0.33998104,0,0.23861918,0,0.18343464,0,0.1488743389;
        0,-0.57735026,0.77459666,-0.33998104,0.53846931,-0.238619186,0.40584515,-0.18343464,0.32425342,-0.1488743389;
        0,0,-0.77459666,0.86113631,-0.53846931,0.661120938,-0.40584515,0.5255324,-0.32425342,0.43339539;
        0,0,0,-0.861136312,0.9061798459,-0.66120938,0.74153118,-0.5255324,0.61337143,-0.43339539;
        0,0,0,0,-0.9061798459,0.93246951,-0.74153118,0.7966664774,-0.61337143,0.67940956;
        0,0,0,0,0,-0.93246951,0.94910791,-0.7966664774,0.8360311,-0.6794095682;
        0,0,0,0,0,0,-0.94910791,0.9602898564,-0.8360311,0.8650633666;
        0,0,0,0,0,0,0,-0.9602898564,0.9681602395,-0.8650633666;
        0,0,0,0,0,0,0,0,-0.9681602395,0.9739065285;
        0,0,0,0,0,0,0,0,0,-0.9739065285];
 %% CALCULATION OF INTEGRAL
 sum=0;
for i=1:NGP(1)
            wx=db_wt(i,NGP(1));
            x=db_gp(i,NGP(1));
                if d==1         % if 1D integral
                    sum=sum+wx*eval(I);
                    continue;
                end
    for j=1:NGP(2)
            wy=db_wt(j,NGP(2));
            y=db_gp(j,NGP(2));
                if d==2         % if 2D integral
                    sum=sum+wx*wy*eval(I);
                    continue;
                end
        for k=1:NGP(3)
            wz=db_wt(k,NGP(3));
            z=db_gp(k,NGP(3));
                if d==3         % if 3D integral
                    sum=sum+wx*wy*wz*eval(I);
                    continue;
                end
        end
    end
end                                                     
%% DISPLAY THE RESULTS
fprintf('\nThe Integral I = %G \n',sum);                                       